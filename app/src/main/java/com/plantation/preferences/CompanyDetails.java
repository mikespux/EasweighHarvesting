package com.plantation.preferences;

import android.annotation.TargetApi;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Build;
import android.os.Bundle;
import android.widget.Button;

import androidx.preference.EditTextPreference;
import androidx.preference.Preference;
import androidx.preference.PreferenceFragmentCompat;
import androidx.preference.PreferenceManager;

import com.plantation.R;
import com.plantation.activities.CompanyDetailsActivity;


public class CompanyDetails extends PreferenceFragmentCompat {

    static SharedPreferences mSharedPrefs, prefs;
    EditTextPreference device_terminal, device_phone, device_serial, device_factory;
    EditTextPreference co_prefix, co_name, co_letterbox, co_postcode, co_postname, co_postregion, co_telephone;
    Button btnRefresh;
    Preference button;

    public CompanyDetails() {
    }

    public static CompanyDetails newInstance() {
        CompanyDetails fragment = new CompanyDetails();
        return fragment;
    }

    @Override
    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {

        // Load the preferences from an XML resource
        setPreferencesFromResource(R.xml.company_details, rootKey);

        mSharedPrefs = PreferenceManager.getDefaultSharedPreferences(getActivity());
        prefs = PreferenceManager.getDefaultSharedPreferences(getActivity());

        device_terminal = findPreference("terminalID");
        device_terminal.setTitle(mSharedPrefs.getString("terminalID", "Terminal ID"));

        if (device_terminal.getText().equals("0")) {
            device_terminal.setTitle("Enter Terminal ID");
        }
        if (device_terminal.getText() == null) {
            device_terminal.setVisible(false);
        }

        device_phone = findPreference("PhoneNo");
        device_phone.setTitle(mSharedPrefs.getString("PhoneNo", "Phone"));
        if (device_phone.getText() == null || device_phone.getText().equals("")) {
            device_phone.setVisible(false);
        }
        device_factory = findPreference("Factory");
        device_factory.setTitle(mSharedPrefs.getString("Factory", "Factory"));
        if (device_factory.getText() == null || device_factory.getText().equals("")) {
            device_factory.setVisible(false);
        }
        device_serial = findPreference("device_serial");
        device_serial.setTitle(mSharedPrefs.getString("device_serial", "Serial No"));
        if (device_serial.getText() == null || device_serial.getText().equals("")) {
            device_serial.setVisible(false);
        }
        co_prefix = findPreference("company_prefix");
        co_prefix.setTitle(mSharedPrefs.getString("company_prefix", "Company Prefix"));
        if (co_prefix.getText().equals("")) {
            co_prefix.setVisible(false);
        }

        co_name = findPreference("company_name");
        co_name.setTitle(mSharedPrefs.getString("company_name", "Company Name"));
        if (co_name.getText().equals("")) {
            co_name.setVisible(false);
        }

        co_letterbox = findPreference("company_letterbox");
        co_letterbox.setTitle(mSharedPrefs.getString("company_letterbox", "LetterBox"));
        if (co_letterbox.getText().equals("")) {
            co_letterbox.setVisible(false);
        }
        co_postcode = findPreference("company_postalcode");
        co_postcode.setTitle(mSharedPrefs.getString("company_postalcode", "Postal Code"));
        if (co_postcode.getText().equals("")) {
            co_postcode.setVisible(false);
        }
        co_postname = findPreference("company_postalname");
        co_postname.setTitle(mSharedPrefs.getString("company_postalname", "Postal Name"));
        if (co_postname.getText().equals("")) {
            co_postname.setVisible(false);
        }
        co_postregion = findPreference("company_postregion");
        co_postregion.setTitle(mSharedPrefs.getString("company_postregion", "Region"));
        if (co_postregion.getText().equals("")) {
            co_postregion.setVisible(false);
        }
        co_telephone = findPreference("company_posttel");
        co_telephone.setTitle(mSharedPrefs.getString("company_posttel", "Telephone"));
        if (co_telephone.getText().equals("")) {
            co_telephone.setVisible(false);
        }


        button = (Preference) getPreferenceManager().findPreference("btn_Refresh");
        if (button != null) {
            button.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
                @Override
                public boolean onPreferenceClick(Preference arg0) {
                    SharedPreferences.Editor edit = mSharedPrefs.edit();

                    edit.putBoolean("prefs_refresh", true);
                    edit.commit();
                    refreshBtn();
                    return true;
                }
            });
        }

//         btnRefresh = getActivity().findViewById(R.id.btnRefresh);
//        btnRefresh.setOnClickListener(new View.OnClickListener() {
//            @Override
//            public void onClick(View v) {
//                refreshBtn();
//            }
//        });
    }

    @Override
    public void onResume() {
        super.onResume();
        device_terminal = findPreference("terminalID");
        device_terminal.setTitle(mSharedPrefs.getString("terminalID", "Terminal ID"));

        if (device_terminal.getText().equals("0")) {
            device_terminal.setTitle("Enter Terminal ID");
        }
        if (device_terminal.getText() == null) {
            device_terminal.setVisible(false);
        }

        device_phone = findPreference("PhoneNo");
        device_phone.setTitle(mSharedPrefs.getString("PhoneNo", "Phone"));
        if (device_phone.getText() == null || device_phone.getText().equals("")) {
            device_phone.setVisible(false);
        }
        device_factory = findPreference("Factory");
        device_factory.setTitle(mSharedPrefs.getString("Factory", "Factory"));
        if (device_factory.getText() == null || device_factory.getText().equals("")) {
            device_factory.setVisible(false);
        }
        device_serial = findPreference("device_serial");
        device_serial.setTitle(mSharedPrefs.getString("device_serial", "Serial No"));
        if (device_serial.getText() == null || device_serial.getText().equals("")) {
            device_serial.setVisible(false);
        }
        co_prefix = findPreference("company_prefix");
        co_prefix.setTitle(mSharedPrefs.getString("company_prefix", "Company Prefix"));
        if (co_prefix.getText().equals("")) {
            co_prefix.setVisible(false);
        }

        co_name = findPreference("company_name");
        co_name.setTitle(mSharedPrefs.getString("company_name", "Company Name"));
        if (co_name.getText().equals("")) {
            co_name.setVisible(false);
        }

        co_letterbox = findPreference("company_letterbox");
        co_letterbox.setTitle(mSharedPrefs.getString("company_letterbox", "LetterBox"));
        if (co_letterbox.getText().equals("")) {
            co_letterbox.setVisible(false);
        }
        co_postcode = findPreference("company_postalcode");
        co_postcode.setTitle(mSharedPrefs.getString("company_postalcode", "Postal Code"));
        if (co_postcode.getText().equals("")) {
            co_postcode.setVisible(false);
        }
        co_postname = findPreference("company_postalname");
        co_postname.setTitle(mSharedPrefs.getString("company_postalname", "Postal Name"));
        if (co_postname.getText().equals("")) {
            co_postname.setVisible(false);
        }
        co_postregion = findPreference("company_postregion");
        co_postregion.setTitle(mSharedPrefs.getString("company_postregion", "Region"));
        if (co_postregion.getText().equals("")) {
            co_postregion.setVisible(false);
        }
        co_telephone = findPreference("company_posttel");
        co_telephone.setTitle(mSharedPrefs.getString("company_posttel", "Telephone"));
        if (co_telephone.getText().equals("")) {
            co_telephone.setVisible(false);
        }
    }

    public void refreshBtn() {
        Intent mIntent = new Intent(getActivity(), CompanyDetailsActivity.class);
        startActivity(mIntent);
    }

    @TargetApi(Build.VERSION_CODES.JELLY_BEAN)
    public void onBackPressed() {
        //Display alert message when back button has been pressed
        return;
    }


}
